{"ast":null,"code":"import React,{Component}from'react';import'./DatabaseDemo.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";class DatabaseDemo extends Component{constructor(props){super(props);//since we are extending class Table so we have to use super in order to override Component class constructor\nthis.handleTextChange=this.handleTextChange.bind(this);this.handleButtonClick=this.handleButtonClick.bind(this);this.handleButtonClickDel=this.handleButtonClickDel.bind(this);this.state={transactions:[],text_amt:\"\",text_desc:\"\"};}componentDidMount(){this.populateData();}populateData(){this.fetch_retry('/api/transaction',3).then(res=>res.json()).then(data=>{this.setState({transactions:data.result});console.log(\"state set\");console.log(this.state.transactions);}).catch(console.log);}async fetch_retry(url,n){try{return await fetch(url);}catch(err){if(n===1)throw err;await new Promise(resolve=>setTimeout(resolve,1000));return await this.fetch_retry(url,n-1);}}renderTableData(){return this.state.transactions.map((transaction,index)=>{const{id,amount,description}=transaction;//destructuring\nreturn/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:id}),/*#__PURE__*/_jsx(\"td\",{children:amount}),/*#__PURE__*/_jsx(\"td\",{children:description})]},id);});}handleButtonClickDel(){const requestOptions={method:'DELETE'};fetch('/api/transaction',requestOptions).then(response=>response.json()).then(data=>this.populateData());this.setState({text_amt:\"\",text_desc:\"\",transaction:[]});}handleButtonClick(){console.log(this.state.text_amt);console.log(this.state.text_desc);const requestOptions={method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({\"amount\":this.state.text_amt,\"desc\":this.state.text_desc})};fetch('/api/transaction',requestOptions).then(response=>response.json()).then(data=>this.populateData());this.setState({text_amt:\"\",text_desc:\"\"});}handleTextChange(e){this.setState({[e.target.name]:e.target.value});}render(){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{id:\"title\",style:{paddingRight:\"1em\"},children:\"Aurora Database Demo Page\"}),/*#__PURE__*/_jsx(\"input\",{style:{float:\"right\",marginBottom:\"1em\"},type:\"button\",value:\"DEL\",onClick:this.handleButtonClickDel}),/*#__PURE__*/_jsx(\"table\",{id:\"transactions\",children:/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:\"ID\"}),/*#__PURE__*/_jsx(\"td\",{children:\"AMOUNT\"}),/*#__PURE__*/_jsx(\"td\",{children:\"DESC\"})]}),/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"button\",value:\"ADD\",onClick:this.handleButtonClick})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"text_amt\",value:this.state.text_amt,onChange:this.handleTextChange})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"text_desc\",value:this.state.text_desc,onChange:this.handleTextChange})})]}),this.renderTableData()]})})]});}}export default DatabaseDemo;","map":{"version":3,"names":["React","Component","jsx","_jsx","jsxs","_jsxs","DatabaseDemo","constructor","props","handleTextChange","bind","handleButtonClick","handleButtonClickDel","state","transactions","text_amt","text_desc","componentDidMount","populateData","fetch_retry","then","res","json","data","setState","result","console","log","catch","url","n","fetch","err","Promise","resolve","setTimeout","renderTableData","map","transaction","index","id","amount","description","children","requestOptions","method","response","headers","body","JSON","stringify","e","target","name","value","render","style","paddingRight","float","marginBottom","type","onClick","onChange"],"sources":["/home/centos/aws-three-tier-web-architecture-workshop/application-code/web-tier/src/components/DatabaseDemo/DatabaseDemo.js"],"sourcesContent":["\n    import React, {Component} from 'react';\n    import './DatabaseDemo.css';\n\n    class DatabaseDemo extends Component {\n     \n        constructor(props) {\n            super(props) //since we are extending class Table so we have to use super in order to override Component class constructor\n            this.handleTextChange = this.handleTextChange.bind(this);\n            this.handleButtonClick = this.handleButtonClick.bind(this);\n            this.handleButtonClickDel = this.handleButtonClickDel.bind(this);\n            this.state = { \n               transactions: [],\n               text_amt: \"\",\n               text_desc:\"\"\n            }\n         }\n\n         componentDidMount() {\n            this.populateData();\n          }\n\n        populateData(){\n            this.fetch_retry('/api/transaction',3)\n            .then(res => res.json())\n            .then((data) => {\n              this.setState({ transactions : data.result });\n              console.log(\"state set\");\n              console.log(this.state.transactions);\n            })\n            .catch(console.log);\n        }  \n\n        async fetch_retry(url, n){\n            try {\n                return await fetch(url)\n            } catch(err) {\n                if (n === 1) throw err;\n                await new Promise(resolve => setTimeout(resolve, 1000)); \n                return await this.fetch_retry(url, n - 1);\n            }\n        };\n\n\n          renderTableData() {\n            return this.state.transactions.map((transaction, index) => {\n               const { id, amount, description} = transaction //destructuring\n               return (\n                  <tr key={id}>\n                     <td>{id}</td>\n                     <td>{amount}</td>\n                     <td>{description}</td>\n                  </tr>\n               )\n            })\n         }\n\n        handleButtonClickDel(){\n           const requestOptions = {\n               method: 'DELETE'\n           }\n           fetch('/api/transaction', requestOptions)\n           .then(response => response.json())\n           .then(data => this.populateData())\n\n           this.setState({text_amt : \"\", text_desc:\"\",transaction:[]});\n\n        }\n\n         handleButtonClick(){\n             console.log(this.state.text_amt);\n             console.log(this.state.text_desc);\n            const requestOptions = {\n                method: 'POST',\n                headers: {'Content-Type':'application/json'},\n                body: JSON.stringify({\"amount\":this.state.text_amt, \"desc\" :this.state.text_desc})\n            }\n            \n            fetch('/api/transaction', requestOptions)\n            .then(response => response.json())\n            .then(data => this.populateData())\n            \n            this.setState({text_amt : \"\", text_desc:\"\"});\n\n         }\n\n         handleTextChange(e){\n            this.setState({[e.target.name]:e.target.value})\n         }\n\n\n        render () {\n        return (\n            <div>\n            <h1 id='title' style={{paddingRight:\"1em\"}}>Aurora Database Demo Page</h1><input style={{float:\"right\", marginBottom:\"1em\"}} type = \"button\" value =\"DEL\" onClick={this.handleButtonClickDel} />\n            <table id='transactions'>\n               <tbody>\n                   <tr>\n                       <td>ID</td>\n                       <td>AMOUNT</td>\n                       <td>DESC</td>\n                   </tr>\n                   <tr>\n                        <td><input type = \"button\" value =\"ADD\" onClick={this.handleButtonClick}/></td>\n                        <td><input type=\"text\" name =\"text_amt\" value = {this.state.text_amt} onChange={this.handleTextChange}/></td>\n                        <td><input type=\"text\" name = \"text_desc\" value = {this.state.text_desc} onChange={this.handleTextChange}/></td>\n                   </tr>\n                  {this.renderTableData()}\n               </tbody>\n            </table>\n         </div>\n\n        );\n      }\n    }\n\n    export default DatabaseDemo;"],"mappings":"AACI,MAAO,CAAAA,KAAK,EAAGC,SAAS,KAAO,OAAO,CACtC,MAAO,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE5B,KAAM,CAAAC,YAAY,QAAS,CAAAL,SAAU,CAEjCM,WAAWA,CAACC,KAAK,CAAE,CACf,KAAK,CAACA,KAAK,CAAC,CAAC;AACb,IAAI,CAACC,gBAAgB,CAAG,IAAI,CAACA,gBAAgB,CAACC,IAAI,CAAC,IAAI,CAAC,CACxD,IAAI,CAACC,iBAAiB,CAAG,IAAI,CAACA,iBAAiB,CAACD,IAAI,CAAC,IAAI,CAAC,CAC1D,IAAI,CAACE,oBAAoB,CAAG,IAAI,CAACA,oBAAoB,CAACF,IAAI,CAAC,IAAI,CAAC,CAChE,IAAI,CAACG,KAAK,CAAG,CACVC,YAAY,CAAE,EAAE,CAChBC,QAAQ,CAAE,EAAE,CACZC,SAAS,CAAC,EACb,CAAC,CACJ,CAEAC,iBAAiBA,CAAA,CAAG,CACjB,IAAI,CAACC,YAAY,CAAC,CAAC,CACrB,CAEFA,YAAYA,CAAA,CAAE,CACV,IAAI,CAACC,WAAW,CAAC,kBAAkB,CAAC,CAAC,CAAC,CACrCC,IAAI,CAACC,GAAG,EAAIA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACvBF,IAAI,CAAEG,IAAI,EAAK,CACd,IAAI,CAACC,QAAQ,CAAC,CAAEV,YAAY,CAAGS,IAAI,CAACE,MAAO,CAAC,CAAC,CAC7CC,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC,CACxBD,OAAO,CAACC,GAAG,CAAC,IAAI,CAACd,KAAK,CAACC,YAAY,CAAC,CACtC,CAAC,CAAC,CACDc,KAAK,CAACF,OAAO,CAACC,GAAG,CAAC,CACvB,CAEA,KAAM,CAAAR,WAAWA,CAACU,GAAG,CAAEC,CAAC,CAAC,CACrB,GAAI,CACA,MAAO,MAAM,CAAAC,KAAK,CAACF,GAAG,CAAC,CAC3B,CAAE,MAAMG,GAAG,CAAE,CACT,GAAIF,CAAC,GAAK,CAAC,CAAE,KAAM,CAAAE,GAAG,CACtB,KAAM,IAAI,CAAAC,OAAO,CAACC,OAAO,EAAIC,UAAU,CAACD,OAAO,CAAE,IAAI,CAAC,CAAC,CACvD,MAAO,MAAM,KAAI,CAACf,WAAW,CAACU,GAAG,CAAEC,CAAC,CAAG,CAAC,CAAC,CAC7C,CACJ,CAGEM,eAAeA,CAAA,CAAG,CAChB,MAAO,KAAI,CAACvB,KAAK,CAACC,YAAY,CAACuB,GAAG,CAAC,CAACC,WAAW,CAAEC,KAAK,GAAK,CACxD,KAAM,CAAEC,EAAE,CAAEC,MAAM,CAAEC,WAAW,CAAC,CAAGJ,WAAW,CAAC;AAC/C,mBACGjC,KAAA,OAAAsC,QAAA,eACGxC,IAAA,OAAAwC,QAAA,CAAKH,EAAE,CAAK,CAAC,cACbrC,IAAA,OAAAwC,QAAA,CAAKF,MAAM,CAAK,CAAC,cACjBtC,IAAA,OAAAwC,QAAA,CAAKD,WAAW,CAAK,CAAC,GAHhBF,EAIL,CAAC,CAEX,CAAC,CAAC,CACL,CAED5B,oBAAoBA,CAAA,CAAE,CACnB,KAAM,CAAAgC,cAAc,CAAG,CACnBC,MAAM,CAAE,QACZ,CAAC,CACDd,KAAK,CAAC,kBAAkB,CAAEa,cAAc,CAAC,CACxCxB,IAAI,CAAC0B,QAAQ,EAAIA,QAAQ,CAACxB,IAAI,CAAC,CAAC,CAAC,CACjCF,IAAI,CAACG,IAAI,EAAI,IAAI,CAACL,YAAY,CAAC,CAAC,CAAC,CAElC,IAAI,CAACM,QAAQ,CAAC,CAACT,QAAQ,CAAG,EAAE,CAAEC,SAAS,CAAC,EAAE,CAACsB,WAAW,CAAC,EAAE,CAAC,CAAC,CAE9D,CAEC3B,iBAAiBA,CAAA,CAAE,CACfe,OAAO,CAACC,GAAG,CAAC,IAAI,CAACd,KAAK,CAACE,QAAQ,CAAC,CAChCW,OAAO,CAACC,GAAG,CAAC,IAAI,CAACd,KAAK,CAACG,SAAS,CAAC,CAClC,KAAM,CAAA4B,cAAc,CAAG,CACnBC,MAAM,CAAE,MAAM,CACdE,OAAO,CAAE,CAAC,cAAc,CAAC,kBAAkB,CAAC,CAC5CC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAAC,CAAC,QAAQ,CAAC,IAAI,CAACrC,KAAK,CAACE,QAAQ,CAAE,MAAM,CAAE,IAAI,CAACF,KAAK,CAACG,SAAS,CAAC,CACrF,CAAC,CAEDe,KAAK,CAAC,kBAAkB,CAAEa,cAAc,CAAC,CACxCxB,IAAI,CAAC0B,QAAQ,EAAIA,QAAQ,CAACxB,IAAI,CAAC,CAAC,CAAC,CACjCF,IAAI,CAACG,IAAI,EAAI,IAAI,CAACL,YAAY,CAAC,CAAC,CAAC,CAElC,IAAI,CAACM,QAAQ,CAAC,CAACT,QAAQ,CAAG,EAAE,CAAEC,SAAS,CAAC,EAAE,CAAC,CAAC,CAE/C,CAEAP,gBAAgBA,CAAC0C,CAAC,CAAC,CAChB,IAAI,CAAC3B,QAAQ,CAAC,CAAC,CAAC2B,CAAC,CAACC,MAAM,CAACC,IAAI,EAAEF,CAAC,CAACC,MAAM,CAACE,KAAK,CAAC,CAAC,CAClD,CAGDC,MAAMA,CAAA,CAAI,CACV,mBACIlD,KAAA,QAAAsC,QAAA,eACAxC,IAAA,OAAIqC,EAAE,CAAC,OAAO,CAACgB,KAAK,CAAE,CAACC,YAAY,CAAC,KAAK,CAAE,CAAAd,QAAA,CAAC,2BAAyB,CAAI,CAAC,cAAAxC,IAAA,UAAOqD,KAAK,CAAE,CAACE,KAAK,CAAC,OAAO,CAAEC,YAAY,CAAC,KAAK,CAAE,CAACC,IAAI,CAAG,QAAQ,CAACN,KAAK,CAAE,KAAK,CAACO,OAAO,CAAE,IAAI,CAACjD,oBAAqB,CAAE,CAAC,cAChMT,IAAA,UAAOqC,EAAE,CAAC,cAAc,CAAAG,QAAA,cACrBtC,KAAA,UAAAsC,QAAA,eACItC,KAAA,OAAAsC,QAAA,eACIxC,IAAA,OAAAwC,QAAA,CAAI,IAAE,CAAI,CAAC,cACXxC,IAAA,OAAAwC,QAAA,CAAI,QAAM,CAAI,CAAC,cACfxC,IAAA,OAAAwC,QAAA,CAAI,MAAI,CAAI,CAAC,EACb,CAAC,cACLtC,KAAA,OAAAsC,QAAA,eACKxC,IAAA,OAAAwC,QAAA,cAAIxC,IAAA,UAAOyD,IAAI,CAAG,QAAQ,CAACN,KAAK,CAAE,KAAK,CAACO,OAAO,CAAE,IAAI,CAAClD,iBAAkB,CAAC,CAAC,CAAI,CAAC,cAC/ER,IAAA,OAAAwC,QAAA,cAAIxC,IAAA,UAAOyD,IAAI,CAAC,MAAM,CAACP,IAAI,CAAE,UAAU,CAACC,KAAK,CAAI,IAAI,CAACzC,KAAK,CAACE,QAAS,CAAC+C,QAAQ,CAAE,IAAI,CAACrD,gBAAiB,CAAC,CAAC,CAAI,CAAC,cAC7GN,IAAA,OAAAwC,QAAA,cAAIxC,IAAA,UAAOyD,IAAI,CAAC,MAAM,CAACP,IAAI,CAAG,WAAW,CAACC,KAAK,CAAI,IAAI,CAACzC,KAAK,CAACG,SAAU,CAAC8C,QAAQ,CAAE,IAAI,CAACrD,gBAAiB,CAAC,CAAC,CAAI,CAAC,EACjH,CAAC,CACL,IAAI,CAAC2B,eAAe,CAAC,CAAC,EACnB,CAAC,CACJ,CAAC,EACN,CAAC,CAGT,CACF,CAEA,cAAe,CAAA9B,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}